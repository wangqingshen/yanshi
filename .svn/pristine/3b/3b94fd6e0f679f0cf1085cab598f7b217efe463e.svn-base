{"version":3,"sources":["aui/aui-list-swipe-backup.js"],"names":["window","firstTouchX","firstTouchY","firstTouch","firstTouchTime","touchXDelta","handleTranslateVal","friction","swipeHandle","btnWidth","isMoved","isOpened","auiListSwipe","callback","this","_init","prototype","self","addEventListener","event","console","log","preventDefault","setTranslate","classList","remove","target","document","parentNode","contains","changedTouches","clientX","clientY","timeStamp","className","indexOf","toggleEvents","element","setTransform","style","backgroundColor","nextSibling","querySelector","stopPropagation","offsetWidth","touchMoveObj","touchX","Math","pow","moveX","moveY","direction","getDirection","angle","getAngle","abs","screenX","touchEndObj","toucheEndX","x","y","toucheEndY","add","status","dom","el","value","webkitTransitionDuration","transitionDuration","webkitTransform","transform","getDistance","p1","p2","props","sqrt","z","round","asin","PI"],"mappings":"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","file":"aui-list-swipe-backup.js","sourcesContent":["/**\r\n * aui-list-swipe.js 列表页滑动菜单\r\n * verson 0.0.3\r\n * @author 流浪男 && Beck\r\n * http://www.auicss.com\r\n * @todo more things to abstract, e.g. Loading css etc.\r\n * Licensed under the MIT license.\r\n * http://www.opensource.org/licenses/mit-license.php\r\n */\r\n (function(window) {\r\n\t\"use strict\";\r\n\tvar translateVal,\r\n\t\tfriction = 1,\r\n\t\tfirstTouchX,\r\n\t\tfirstTouchxy,\r\n\t\tfirstTouchY,\r\n\t\tfirstTouch,\r\n\t\tfirstTouchTime,\r\n\t\ttouchXDelta,\r\n\t\thandleTranslateVal;\r\n\tvar TranslateZero = \"translate3d(0,0,0)\",\r\n\t\tTranslateCent = \"translate3d(100%,0,0)\";\r\n\tvar swipeHandle = false,\r\n\t\tbtnWidth = false,\r\n\t\tswipeBtnsRight = false;\r\n\tvar isMoved = false,isOpened=false;\r\n\tvar d = false;\r\n\tvar auiListSwipe = function (callback) {\r\n\t\tthis._init(callback);\r\n\t}\r\n\tauiListSwipe.prototype = {\r\n\t\t// var self = this;\r\n\t\t_init: function(callback){\r\n\t\t\tvar self = this;\r\n\t\t\t// var d = document.querySelectorAll(\"selectors\")\r\n\t\t\twindow.addEventListener('touchstart', function(event){\r\n\t\t\t\tif(isOpened){\r\n\t\t\t\t\tconsole.log(1)\r\n\t\t\t\t\t// return;\r\n\t\t\t\t\tisOpened = false;\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif(swipeHandle){\r\n\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\tself.setTranslate(swipeHandle,\"0px\");\r\n\t\t\t\t\tswipeHandle.classList.remove(\"aui-swipe-opened\");\r\n\t\t\t\t\tswipeHandle = false;\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tisMoved = false;\r\n\t\t\t\tswipeHandle = false;\r\n\t\t\t\tvar target = event.target;\r\n\t\t\t\t// 过滤点击\r\n\t\t\t\tfor(; target && target !== document; target = target.parentNode){\r\n\t\t\t\t\t// console.log(target.classList)\r\n\t\t\t\t\tif (target.classList){\r\n\t\t\t\t\t\tif (target.classList.contains(\"aui-swipe-handle\")) {\r\n\t\t\t\t\t\t\tswipeHandle = target;\r\n\t\t\t\t\t\t\tfirstTouch = event.changedTouches[0];\r\n\t\t\t\t\t\t\tfirstTouchX = firstTouch.clientX;\r\n\t\t\t\t\t\t\tfirstTouchY = firstTouch.clientY;\r\n\t\t\t\t\t\t\tfirstTouchTime = event.timeStamp;\r\n\t\t\t\t\t\t\tif(swipeHandle.className.indexOf(\"aui-swipe-opened\") > -1){\r\n\t\t\t\t\t\t\t// \tconsole.log(1)\r\n\t\t\t\t\t\t\t\t// self.setTranslate(swipeHandle,\"0px\");\r\n\t\t\t\t\t\t\t\t// swipeHandle.classList.remove(\"aui-swipe-opened\");\r\n\t\t\t\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\t\t// setTimeout(function(){\r\n\t\t\t\t\t\t\t\t\tself.toggleEvents(swipeHandle,callback);\r\n\t\t\t\t\t\t\t\t// }, 100)\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\r\n\t\t\t})\r\n\t\t\t// window.addEventListener('touchmove', function(event){\r\n\t\t\t// \tif(swipeHandle){\r\n\t\t\t// \t\t// event.preventDefault();\r\n\t\t\t// \t\t// self.setTranslate(swipeHandle,\"0px\");\r\n\t\t\t// \t\t// swipeHandle.classList.remove(\"aui-swipe-opened\");\r\n\t\t\t// \t\t// swipeHandle = false;\r\n\t\t\t// \t\t// return;\r\n\t\t\t// \t}\r\n\t\t\t// \tif(document.querySelector(\".aui-swipe-opened\")){\r\n\t\t\t// \t\tevent.preventDefault();\r\n\t\t\t// \t\tif(swipeHandle != document.querySelector(\".aui-swipe-opened\")){\r\n\t\t\t// \t\t\tself.setTranslate(document.querySelector(\".aui-swipe-opened\"),\"0px\");\r\n\t\t\t//         \tdocument.querySelector(\".aui-swipe-opened\").classList.remove(\"aui-swipe-opened\");\r\n\t\t\t//         \tisOpened = false;\r\n\r\n\t\t\t//         \tevent.stopPropagation()\r\n\t\t\t//         \treturn;\r\n\t\t\t// \t\t}\r\n\t\t\t// \t}\r\n\t\t\t// })\r\n\t\t\twindow.addEventListener(\"touchmove\", function(){\r\n\r\n\t\t\t})\r\n\t\t},\r\n\t\ttoggleEvents:function(element,callback){\r\n\t\t\tif(!swipeHandle){\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar self = this;\r\n\t\t\tself.setTransform(element,300);\r\n\t\t\telement.addEventListener('touchstart', function(event){\r\n\t\t\t\t// if(element.className.indexOf(\"aui-swipe-opened\") > -1){\r\n\t\t\t\t// \tself.setTranslate(element,\"0px\");\r\n\t\t\t\t// \telement.classList.remove(\"aui-swipe-opened\");\r\n\t\t\t\t// \treturn;\r\n\t\t\t\t// }\r\n\t\t\t\t//:active样式引起列表背景色冲突\r\n\r\n\t\t\t\telement.parentNode.style.backgroundColor = \"#ffffff\";\r\n\t\t\t\tif(!element.nextSibling)return;\r\n\t\t\t},false)\r\n\t\t\telement.addEventListener('touchmove', function(event){\r\n\t\t\t\tif(document.querySelector(\".aui-swipe-opened\")){\r\n\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\tif(swipeHandle != document.querySelector(\".aui-swipe-opened\")){\r\n\t\t\t\t\t\tself.setTranslate(document.querySelector(\".aui-swipe-opened\"),\"0px\");\r\n\t\t\t        \tdocument.querySelector(\".aui-swipe-opened\").classList.remove(\"aui-swipe-opened\");\r\n\t\t\t        \tisOpened = false;\r\n\t\t\t        \tevent.stopPropagation()\r\n\t\t\t        \treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t// self.getAngle(event)\r\n\t\t\t\tself.setTransform(element,0);\r\n\t\t\t\t// if(element.className.indexOf(\"aui-swipe-opened\") > -1)return;\r\n\r\n\t\t\t\tif(element.parentNode.querySelector(\".aui-swipe-btn\")){\r\n\t\t\t\t\tbtnWidth = element.parentNode.querySelector(\".aui-swipe-btn\").offsetWidth;\r\n\t\t\t\t}\r\n\t\t\t\t// 列表触摸滑动时如果有已经显示的将其关闭，并退出。\r\n\t\t\t\tvar touchMoveObj = event.changedTouches[0],\r\n\t\t\t\t\ttouchX = touchMoveObj.clientX;\r\n\t\t\t\ttouchXDelta = -Math.pow(firstTouchX-touchX, 0.85);\r\n\t\t\t\thandleTranslateVal = touchXDelta/friction;\r\n\t\t\t\t// touchXDelta = touchX - firstTouchX;\r\n\t\t\t\t// handleTranslateVal = touchXDelta/0.15;\r\n\t\t\t\t// console.log(handleTranslateVal)\r\n\t\t        var moveX = touchMoveObj.clientX - firstTouchX;\r\n\t\t        var moveY = touchMoveObj.clientY - firstTouchY;\r\n\t\t        var direction = self.getDirection(moveX,moveY);\r\n\t\t        var angle = self.getAngle(Math.abs(moveX),Math.abs(moveY));\r\n\t\t        // console.log(isMoved);\r\n\r\n\t\t        // // 解决滑动屏幕返回时事件冲突，主要针对部分特殊机型\r\n\t\t        // if(touchMoveObj.screenX < 0){\r\n\t\t        // \tfirstTouchxy = '';\r\n\t\t        // }\r\n\t\t        if(direction == \"right\"){\r\n\t\t        \tisMoved = false;\r\n\t\t        \tevent.preventDefault();\r\n\t\t        }\r\n\t\t        if(direction == \"top\" || direction == \"down\"){\r\n\t\t        \tisMoved = false;\r\n\t\t        \treturn;\r\n\t\t        }\r\n\t\t        if(angle <= 15 && direction === 'left'){\r\n\t\t        \tevent.preventDefault()\r\n\t\t        \tisMoved = true;\r\n\t\t        }\r\n\t\t        // console.log(handleTranslateVal)\r\n\t\t        // if(isMoved)self.setTranslate(element,\"\"+(handleTranslateVal+10)+\"px\");\r\n\t\t        if((event.timeStamp - firstTouchTime) >= 100 && touchXDelta < 0 && touchMoveObj.screenX > 0 && isMoved){\r\n\t\t        \t// event.stopPropagation();\r\n\t\t        \t// element.classList.add(\"aui-swipe-moving\");\r\n\t\t        \t// event.preventDefault();\r\n\t\t        \tif(element.className.indexOf(\"aui-swipe-opened\") <= -1){\r\n\t\t\t\t\t\tif((handleTranslateVal+10) > -btnWidth){\r\n\t\t\t\t        \tself.setTranslate(element,\"\"+(handleTranslateVal+10)+\"px\");\r\n\t\t\t\t        }\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\treturn\r\n\t\t\t\t\t}\r\n\r\n\t\t\t    }\r\n\t\t\t},false)\r\n\t\t\telement.addEventListener('touchend', function(event){\r\n\t\t\t\tself.setTransform(element,300);\r\n\t\t\t\tvar touchEndObj = event.changedTouches[0];\r\n\t\t\t\tvar touchEndxy = {\r\n\t\t\t\t\t\tx: touchEndObj.clientX || 0,\r\n\t\t\t\t\t\ty: touchEndObj.clientY || 0\r\n\t\t\t\t\t};\r\n\t\t\t\tvar toucheEndX = touchEndObj.clientX - firstTouchX;\r\n\t\t        var toucheEndY = touchEndObj.clientY - firstTouchY;\r\n\t\t        var direction = self.getDirection(toucheEndX,toucheEndY);\r\n\t\t        // element.classList.remove(\"aui-swipe-moving\");\r\n\t        \tif(direction=='left' && handleTranslateVal < (-btnWidth/3) && isMoved){\r\n\t\t        \tself.setTranslate(element,\"\"+-btnWidth+\"px\");\r\n\t\t        \telement.classList.add(\"aui-swipe-opened\");\r\n\t\t        \tcallback({\r\n\t\t        \t\t'status':true,\r\n\t\t        \t\t'dom':element\r\n\t\t        \t})\r\n\t\t        \tisOpened = true;\r\n\t\t\t\t}else{\r\n\t\t\t\t\telement.classList.remove(\"aui-swipe-opened\");\r\n\t\t        \tself.setTranslate(element,\"0px\");\r\n\t\t        \tisOpened = false;\r\n\t\t\t\t}\r\n\t\t\t\t// isMoved = false;\r\n\t\t\t\tconsole.log(isOpened)\r\n\t\t\t},true)\r\n\t\t},\r\n\t\tsetTransform : function (el,value){\r\n\t\t\tel.style.webkitTransitionDuration = el.style.transitionDuration = value+'ms';\r\n\t\t},\r\n\t\tsetTranslate : function (el,value){\r\n\t\t\tif(el)el.style.webkitTransform = el.style.transform = \"translate3d(\"+value+\",0,0)\";\r\n\t\t},\r\n\t\tgetDistance : function(p1, p2, props) {\r\n\t\t\tif (!props) { props = ['x', 'y'];}\r\n\t\t\tvar x = p2[props[0]] - p1[props[0]];\r\n\t\t\tvar y = p2[props[1]] - p1[props[1]];\r\n\t\t\treturn Math.sqrt((x * x) + (y * y));\r\n\t\t},\r\n\t\tgetAngle:function(moveX, moveY){\r\n\t\t       // var x = Math.abs(x1 - x2);\r\n\t\t       // var y = Math.abs(y1 - y2);\r\n\t\t       var z = Math.sqrt(moveX*moveX + moveY*moveY);\r\n\t\t       return  Math.round((Math.asin(moveY / z) / Math.PI*180));\r\n\t\t},\r\n\t\tgetDirection : function(x, y) {\r\n\t\t\tif (x === y) { return '';}\r\n\t\t\tif (Math.abs(x) >= Math.abs(y)) {\r\n\t            return x > 0 ? 'right' : 'left';\r\n\t        } else {\r\n\t           \treturn y > 0 ? 'down' : 'up';\r\n\t        }\r\n\t\t}\r\n\t}\r\n\twindow.auiListSwipe = auiListSwipe;\r\n})(window);"]}